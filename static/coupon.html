<!DOCTYPE html>
<html lang="ko">
<head>
    <title>ê²½í’ˆ êµí™˜ê¶Œ</title>
    <style> /* ... CSS ìŠ¤íƒ€ì¼ ... */ </style>
</head>
<body>
    <h1>ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰</h1>
    <h2 id="prize-name">ê²½í’ˆ ì´ë¦„</h2>
    <p>êµí™˜ ì½”ë“œ: <b id="redeem-code" style="font-size: 1.5em; color: red;"></b></p>
    <hr>
    <div id="admin-section">
        <h3>ìš´ì˜ì í™•ì¸ë€</h3>
        <input type="password" id="admin-code" placeholder="ìš´ì˜ì ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
        <button id="redeem-btn">ê²½í’ˆ ì§€ê¸‰ í™•ì¸</button>
        <p id="result-message"></p>
    </div>

   <script>
    const prizeNameEl = document.getElementById('prize-name');
    const redeemCodeEl = document.getElementById('redeem-code');
    const adminCodeInput = document.getElementById('admin-code');
    const redeemBtn = document.getElementById('redeem-btn');
    const resultMessageEl = document.getElementById('result-message');
    
    // âœ¨ URL íŒŒë¼ë¯¸í„°ì—ì„œ 'code'ì™€ 'prize'ë¥¼ ê°€ì ¸ì™€ì„œ í™”ë©´ì— í‘œì‹œ
    const urlParams = new URLSearchParams(window.location.search);
    const redeemCode = urlParams.get('code');
    const prizeName = urlParams.get('prize');

    redeemCodeEl.textContent = redeemCode;
    prizeNameEl.textContent = prizeName;

    redeemBtn.onclick = () => {
        const adminCode = adminCodeInput.value;
        if (!adminCode) {
            alert("ìš´ì˜ì ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
            return;
        }

        // âœ¨ ì„œë²„ì— 'redeemCode'ì™€ 'adminCode'ë¥¼ í•¨ê»˜ ì „ì†¡
        fetch('/api/redeem', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ redeemCode: redeemCode, adminCode: adminCode })
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                resultMessageEl.style.color = 'red';
                resultMessageEl.textContent = `ì˜¤ë¥˜: ${data.error}`;
            } else {
                resultMessageEl.style.color = 'green';
                resultMessageEl.textContent = data.message;
                document.getElementById('admin-section').innerHTML = "<h2>ì§€ê¸‰ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</h2>";
            }
        });
    };
</script>
</body>
</html>